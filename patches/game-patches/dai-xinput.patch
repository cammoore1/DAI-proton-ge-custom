diff --git a/dlls/user32/input.c b/dlls/user32/input.c
index 8cb4c1f6f07..8d493166f90 100644
--- a/dlls/user32/input.c
+++ b/dlls/user32/input.c
@@ -780,8 +780,19 @@ HWND WINAPI GetActiveWindow(void)
 HWND WINAPI GetFocus(void)
 {
     GUITHREADINFO info;
+    HWND retValueWindow;
+    static HWND prev = 0;
+
     info.cbSize = sizeof(info);
-    return NtUserGetGUIThreadInfo( GetCurrentThreadId(), &info ) ? info.hwndFocus : 0;
+
+    retValueWindow = NtUserGetGUIThreadInfo( GetCurrentThreadId(), &info ) ? info.hwndFocus : 0;
+
+    if (retValueWindow == 0 && prev != 0)
+        NtUserAttachThreadInput(0, 0, 1);
+    else
+        prev = retValueWindow;
+
+    return retValueWindow;
 }
 
 
diff --git a/dlls/win32u/input.c b/dlls/win32u/input.c
index 3cb7fc3341c..f28da7b086c 100644
--- a/dlls/win32u/input.c
+++ b/dlls/win32u/input.c
@@ -587,6 +587,22 @@ HWND get_focus(void)
 BOOL WINAPI NtUserAttachThreadInput( DWORD from, DWORD to, BOOL attach )
 {
     BOOL ret;
+    static int visited = 0;
+    static DWORD fromThreadForHack = 0;
+    static DWORD toThreadForHack = 0;
+
+    if (!visited)
+    {
+        fromThreadForHack = from;
+	toThreadForHack = to;
+	visited = 1;
+    }
+
+    if (from == 0 && to == 0 && visited)
+    {
+        from = fromThreadForHack;
+	to = toThreadForHack;
+    }
 
     SERVER_START_REQ( attach_thread_input )
     {
